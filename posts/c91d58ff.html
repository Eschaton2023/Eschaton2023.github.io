<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【方法】Docker相关应用部署及操作笔记 | Eschaton的博客</title><meta name="author" content="Eschaton"><meta name="copyright" content="Eschaton"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CentOS7 安装docker $ uname -r&nbsp;&nbsp;&nbsp; //检查CentOS系统内核版本高于3.10 $ sudo yum update&nbsp;&nbsp; //确保yum包更新到最新 $ sudo yum remove docker&nbsp; docker-common docker-selinux docker-engine&nbsp;&nbsp; //卸载旧版本dock">
<meta property="og:type" content="article">
<meta property="og:title" content="【方法】Docker相关应用部署及操作笔记">
<meta property="og:url" content="http://example.com/posts/c91d58ff.html">
<meta property="og:site_name" content="Eschaton的博客">
<meta property="og:description" content="CentOS7 安装docker $ uname -r&nbsp;&nbsp;&nbsp; //检查CentOS系统内核版本高于3.10 $ sudo yum update&nbsp;&nbsp; //确保yum包更新到最新 $ sudo yum remove docker&nbsp; docker-common docker-selinux docker-engine&nbsp;&nbsp; //卸载旧版本dock">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg">
<meta property="article:published_time" content="2024-11-29T02:50:41.000Z">
<meta property="article:modified_time" content="2024-11-29T03:24:03.538Z">
<meta property="article:author" content="Eschaton">
<meta property="article:tag" content="自建">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="Apache">
<meta property="article:tag" content="MariaDB">
<meta property="article:tag" content="Wordpress">
<meta property="article:tag" content="Nginx">
<meta property="article:tag" content="acme.sh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg"><link rel="shortcut icon" href="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg"><link rel="canonical" href="http://example.com/posts/c91d58ff.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【方法】Docker相关应用部署及操作笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-29 11:24:03'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/doublelan.css"><link rel="stylesheet" href="/css/modify.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文库</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background: transparent"><nav id="nav"><span id="blog-info"><a href="/" title="Eschaton的博客"><img class="site-icon" src="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg"><span class="site-name">Eschaton的博客</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 文库</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【方法】Docker相关应用部署及操作笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-11-29T02:50:41.000Z" title="发表于 2024-11-29 10:50:41">2024-11-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-29T03:24:03.538Z" title="更新于 2024-11-29 11:24:03">2024-11-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E3%80%90%E6%96%B9%E6%B3%95%E3%80%91/">【方法】</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【方法】Docker相关应用部署及操作笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="CentOS7-安装docker"><a href="#CentOS7-安装docker" class="headerlink" title="CentOS7 安装docker"></a>CentOS7 安装docker</h1><ol>
<li>$ uname -r&nbsp;&nbsp;&nbsp; //检查CentOS系统内核版本高于3.10</li>
<li>$ sudo yum update&nbsp;&nbsp; //确保yum包更新到最新</li>
<li>$ sudo yum remove docker&nbsp; docker-common docker-selinux docker-engine&nbsp;&nbsp; //卸载旧版本docker</li>
<li>$ sudo yum install -y yum-utils device-mapper-persistent-data lvm2&nbsp; //安装软件包，yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</li>
<li>$ sudo yum-config-manager –add-repo <a target="_blank" rel="noopener" href="https://download.docker.com/linux/centos/docker-ce.repo">https://download.docker.com/linux/centos/docker-ce.repo</a>&nbsp;&nbsp;&nbsp; //设置yum源</li>
<li>$ yum list docker-ce –showduplicates | sort -r&nbsp; //列出仓库中docker版本</li>
<li>$ sudo yum install docker-ce<br>&nbsp; $ sudo yum install docker-ce-17.12.0.ce&nbsp;&nbsp; //选自己要安装的版本</li>
<li>$ sudo systemctl start docker<br>$ sudo systemctl enable docker&nbsp;&nbsp; //启动并加入开机启动</li>
<li>$ docker version&nbsp;&nbsp;&nbsp; //验证是否安装成功</li>
</ol>
<h1 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h1><p><strong>卸载Docker</strong><br>yum remove docker <br>docker-client <br>docker-client-latest <br>docker-common <br>docker-latest <br>docker-latest-logrotate <br>docker-logrotate <br>docker-selinux <br>docker-engine-selinux <br>docker-engine <br>docker-ce</p>
<p><strong>安装yum工具</strong><br>yum install -y yum-utils <br>&nbsp;&nbsp;&nbsp;&nbsp; device-mapper-persistent-data <br>&nbsp;&nbsp;&nbsp;&nbsp; lvm2 –skip-broken<br>&nbsp;&nbsp;&nbsp;&nbsp;<br><strong>centos镜像源更改</strong>：<br>编辑 /etc/yum.repos.d/CentOS-Base.repo 文件<br>把4处网址的mirrorlist注释掉，去掉baseurl的注释，把地址替换为mirrors.tuna.tsinghua.edu.cn<br>dd：删除光标所在那一列</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[base]</span><br><span class="line">name=CentOS-$releasever - Base</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/os/$basearch/</span><br><span class="line">#注释此处mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7</span><br><span class="line"></span><br><span class="line">#released updates</span><br><span class="line">[updates]</span><br><span class="line">name=CentOS-$releasever - Updates</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/updates/$basearch/</span><br><span class="line">#注释此处mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7</span><br><span class="line"></span><br><span class="line">#additional packages that may be useful</span><br><span class="line">[extras]</span><br><span class="line">name=CentOS-$releasever - Extras</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/extras/$basearch/</span><br><span class="line">#注释此处mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7</span><br><span class="line"></span><br><span class="line">#additional packages that extend functionality of existing packages</span><br><span class="line">[centosplus]</span><br><span class="line">name=CentOS-$releasever - Plus</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos/$releasever/centosplus/$basearch/</span><br><span class="line">#注释此处mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=0</span><br><span class="line">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-7</span><br></pre></td></tr></tbody></table></figure>

<p><strong>更新软件包缓存</strong><br>yum makecache<br>yum install -y docker</p>
<p><strong>配置docker镜像加速器</strong><br>sudo mkdir -p /etc/docker<br>sudo tee /etc/docker/daemon.json &lt;&lt;-‘EOF’<br>{<br>&nbsp; “registry-mirrors”: [“<a target="_blank" rel="noopener" href="https://xfewuv42.mirror.aliyuncs.com" ]"="">https://xfewuv42.mirror.aliyuncs.com"]</a><br>}<br>EOF<br>sudo systemctl daemon-reload<br>sudo systemctl restart docker</p>
<h1 id="Docker-compose安装："><a href="#Docker-compose安装：" class="headerlink" title="Docker-compose安装："></a>Docker-compose安装：</h1><p>1.安装Docker-compose到/usr/local/bin/docker-compose<br>参考(<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/install/#install-compose">https://docs.docker.com/compose/install/#install-compose</a>)<br>命令：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose</span><br></pre></td></tr></tbody></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/docker/compose/releases/download/v2.2.0/docker-compose-linux-x86_64">https://github.com/docker/compose/releases/download/v2.2.0/docker-compose-linux-x86_64</a></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L " https://github.com/docker/compose/releases/download/2.2.0/docker-compose- $(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose</span><br></pre></td></tr></tbody></table></figure>
<p>2.添加目录权限sudo chmod +x /usr/local/bin/docker-compose</p>
<p>3.查看Docker-compose版本：docker-compose –version</p>
<h1 id="Docker操作"><a href="#Docker操作" class="headerlink" title="Docker操作"></a>Docker操作</h1><p>搜docker的镜像：<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a><br>systemctl start docker<br>systemctl restart docker<br>systemctl stop docker</p>
<p>不推荐但可选操作：portainer（Docker 的图形化管理工具，提供状态显示面板、应用模板快速部署、容器镜像网络数据卷的基本操作）</p>
<h2 id="镜像操作"><a href="#镜像操作" class="headerlink" title="镜像操作"></a>镜像操作</h2><p>docker images 查看镜像清单<br>docker pull 程序名<br>docker save -o 文件名 镜像名/ID&nbsp;&nbsp; 将镜像导出到盘里<br>docker rmi ID 删除镜像<br>docker load -i 文件名 &nbsp;&nbsp;导入镜像</p>
<h2 id="容器外部操作"><a href="#容器外部操作" class="headerlink" title="容器外部操作"></a>容器外部操作</h2><p>docker ps -a 查看容器状态 -a表示查看所有的，包括没在跑的容器<br>docker run新建并启动容器<br>docker start/stop/pause/unpause 容器操作<br>docker exec 进入容器执行命令<br>docker logs 查看容器运行日志<br>docker rm 删除指定容器</p>
<p>docker run –name MyApache -d -p 80:80 httpd<br>–name 指定容器名<br>-d后台运行（如果不加的话会有个黑窗口，关了的话容器就关了）<br>-p 将宿主机端口与容器端口映射，格式：宿主机端口 : 容器端口<br>httpd：镜像名称</p>
<p>docker stop MyApache/ID<br>docker start MyApache<br>docker rm MyApache</p>
<h2 id="容器内部操作"><a href="#容器内部操作" class="headerlink" title="容器内部操作"></a>容器内部操作</h2><p>docker exec -it MariaDB bash<br>-it创建标准输入、输出终端<br>bash进入容器后执行命令<br>或者<br>docker exec -it MariaDB mysql -u root -p<br>相当于进去后直接执行MariaDB了<br>ALTER USER ‘root‘@’localhost’ IDENTIFIED BY ‘&lt;新口令&gt;’;<br>在数据库里修改root口令<br>exit退出数据库<br>exit退出容器</p>
<p>mysql -u root -p<br>show databases;<br>use XXX;<br>show tables;<br>select * from X \G;</p>
<h2 id="数据卷操作"><a href="#数据卷操作" class="headerlink" title="数据卷操作"></a>数据卷操作</h2><p>用来获取、同步、共享或者更改容器内数据<br>Data Volumes：将宿主机中的目录和容器中的某个目录建立映射关系<br>mariadb，wordpress，即使不使用挂载命令也会自动创建挂载目录<br>默认路径：/var/lib/docker/volumes</p>
<p><code>docker volume [COMMAND]</code><br>ls列出所有volume<br>inspect显示一个或多个volume信息<br>create创建<br>rm删除一个或多个volume<br>prune删除未使用的volume</p>
<p>数据卷固定绑定（在/var/lib/docker/volumes目录下都是固定绑定，可被docker volume命令管理）<br>创建容器时 –volume或-v参数挂载一个数据卷到某容器<br>已创建的容器无法再进行挂载！<br>docker volume create Test<br>docker run –name 容器名 -v 数据卷名1:/data -v 数据卷名2:/var/log -d 镜像名<br>将该数据卷1挂载到容器的/data目录下，数据卷2挂载到/var/log目录下，如果数据卷不存在则会自动创建<br>绑定挂载（将其他宿主机目录挂载到容器，有点：可以挂载文件。缺点：无法用docker volume命令管理，多了会很乱，不推荐 ）<br>docker run –name 容器名 -v 路径1:/data -v /root/test:/var/log -d 镜像名<br>将宿主机路径挂载到/data目录下，将宿主机/root/test路径挂载到容器的/var/log目录下<br>挂载volume到当前执行run的目录下的out文件夹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm&nbsp; -itd&nbsp; \</span><br><span class="line">-v "$(pwd)/out":/acme.sh&nbsp; \</span><br><span class="line">--network network1 \</span><br><span class="line">--name=acme \</span><br><span class="line">neilpang/acme.sh daemon</span><br></pre></td></tr></tbody></table></figure>
<p><strong>比如一般备份和挂载操作</strong><br>cd /var/lib/docker/volume<br>cp abcdefg mariadb<br>docker volume create mariadb<br>然后建立容器时挂载到mariadb即可<br>-v mariadb:/var/lib/mysql <br>挂载后可能出现权限问题，进入容器后 docker exec -it mariadb bash后对需要的目录执行chmod -R 777 mysql（777只是图省事）</p>
<h2 id="网络操作"><a href="#网络操作" class="headerlink" title="网络操作"></a>网络操作</h2><p>docker netowrk [COMMAND]<br>Commands:<br>&nbsp; connect&nbsp;&nbsp;&nbsp;&nbsp; 连接到网络<br>&nbsp; create&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 创建一个docker网络<br>&nbsp; disconnect&nbsp; 将一个docker容器从网络中断开<br>&nbsp; inspect&nbsp;&nbsp;&nbsp;&nbsp; 显示一个或多个网络信息<br>&nbsp; ls&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示目前的网络<br>&nbsp; prune&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 删除所有未使用的网络<br>&nbsp; rm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 删除指定网络</p>
<p>docker network ls<br>docker network create network1 network2</p>
<h2 id="部署Apache"><a href="#部署Apache" class="headerlink" title="部署Apache"></a>部署Apache</h2><p>docker pull httpd<br>docker run –name apache <br>–network network1 <br>-v apache:/usr/local/apache2/htdocs/ <br>-d -p 80:80 httpd</p>
<p>挂载哪些目录文件放在哪可以参照<a target="_blank" rel="noopener" href="https://hub.docker.com/_/httpd">https://hub.docker.com/_/httpd</a></p>
<p>/usr/local/apache2# ls<br>bin&nbsp; build&nbsp; cgi-bin&nbsp; conf&nbsp; error&nbsp; htdocs&nbsp; icons&nbsp; include&nbsp; logs&nbsp; modules<br>网页放这里<br>/usr/local/apache2/htdocs</p>
<h2 id="部署MariaDB"><a href="#部署MariaDB" class="headerlink" title="部署MariaDB"></a>部署MariaDB</h2><p>网上拉取镜像<br>docker pull mariadb<br>创建docker网络<br>docker network create network1<br>对数据库进行初始化<br>docker run –name mariadb <br>–network network1 <br>-e MYSQL_ROOT_PASSWORD=你的密码 <br>-v mariadb:/var/lib/mysql <br>-d -p 3306:3306 mariadb</p>
<p>docker run –name mariadb –network network1 -e MYSQL_ROOT_PASSWORD=你的密码 -v mariadb:/var/lib/mysql -d -p 3306:3306 mariadb</p>
<p>数据库建立db_web数据库<br><strong>docker exec -it mariadb mariadb -u root -p</strong><br>输入口令<br>show databases;<br>CREATE DATABASE db_web;<br>show databases;<br>exit</p>
<p>/var/lib/docker/volumes固定挂载卷位置</p>
<p>在安全组中开放3306端口后，可以远程Navicat访问3306端口，建立db_web数据库<br>docker exec -it MariaDB bash<br>-it创建标准输入、输出终端<br>bash进入容器后执行命令<br>或者<br>docker exec -it MariaDB mysql -u root -p<br>docker exec -it MariaDB mariadb -u root -p<br>相当于进去后直接执行MariaDB了<br>ALTER USER ‘root‘@’localhost’ IDENTIFIED BY ‘&lt;新口令&gt;’;<br>在数据库里修改root口令<br>exit退出数据库<br>exit退出容器<br>mysql -u root -p<br>mariadb -u root -p<br>show databases;<br>use XXX;<br>show tables;<br>select * from X \G;<br>exit退出数据库<br>exit退出容器<br>参考的文档和指令<a target="_blank" rel="noopener" href="https://hub.docker.com/_/mariadb">https://hub.docker.com/_/mariadb</a></p>
<h2 id="部署Wordpress"><a href="#部署Wordpress" class="headerlink" title="部署Wordpress"></a>部署Wordpress</h2><p>docker pull wordpress<br>docker run –name wordpress –network network1 <br>-e WORDPRESS_DB_HOST=mariadb <br>-e WORDPRESS_DB_USER=root <br>-e WORDPRESS_DB_PASSWORD=你的密码 <br>-e WORDPRESS_DB_NAME=db_web <br>-v wordpress:/var/www/html <br>-d -p 8080:80 wordpress</p>
<p>docker run –name wordpress –network network1 -e WORDPRESS_DB_HOST=mariadb -e WORDPRESS_DB_USER=root -e WORDPRESS_DB_PASSWORD=你的密码 -e WORDPRESS_DB_NAME=db_web -v wordpress:/var/www/html -d -p 8080:80 wordpress</p>
<p>https://你的域名/wp-admin/install.php?step=1</p>
<p>仪表盘<br>https://你的域名/wp-admin/</p>
<p>/var/lib/docker/volumes固定挂载卷位置<br>docker container run –volumes-from &lt;已创建的容器名称或ID&gt; -v /宿主机目录路径:/容器目录路径 &lt;镜像名称&gt;<br>docker container run –volumes-from 239 -v /home/ec2-user/wordpress: /var/www/html wordpress</p>
<h3 id="Wordpress备份及导入"><a href="#Wordpress备份及导入" class="headerlink" title="Wordpress备份及导入"></a>Wordpress备份及导入</h3><p>安装All-in-One WP Migration 插件<br>一站式WP迁移<br>高版本的all-in-one-wp-migration无法导入，使用6.7版本的即可<br>下载链接：<a target="_blank" rel="noopener" href="https://webhostingadvices.com/wp-content/uploads/2020/05/all-in-one-wp-migration-6.7.zip">https://webhostingadvices.com/wp-content/uploads/2020/05/all-in-one-wp-migration-6.7.zip</a><br>修改wp-config.php中上传文件大小限制<br>cd /var/lib/docker/volumes/wordpress/_data/<br>vim .htaccess</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># BEGIN WordPress</span><br><span class="line"># 在“BEGIN WordPress”与“END WordPress”之间的指令（行）是</span><br><span class="line"># 动态生成的，只应被WordPress过滤器修改。</span><br><span class="line"># 任何对标记之间的指令的修改都会被覆盖。</span><br><span class="line">&lt;IfModule mod_rewrite.c&gt;</span><br><span class="line">RewriteEngine On</span><br><span class="line">RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]</span><br><span class="line">RewriteBase /</span><br><span class="line">RewriteRule ^index\.php$ - [L]</span><br><span class="line">RewriteCond %{REQUEST_FILENAME} !-f</span><br><span class="line">RewriteCond %{REQUEST_FILENAME} !-d</span><br><span class="line">RewriteRule . /index.php [L]</span><br><span class="line">&lt;/IfModule&gt;</span><br><span class="line">php_value upload_max_filesize 128M</span><br><span class="line">php_value post_max_size 128M</span><br><span class="line">php_value memory_limit 256M</span><br><span class="line">php_value max_execution_time 300</span><br><span class="line">php_value max_input_time 300</span><br><span class="line"># END WordPress</span><br></pre></td></tr></tbody></table></figure>

<p>解决无法恢复备份的问题</p>
<p>参考：<a target="_blank" rel="noopener" href="https://webhostingadvices.com/all-in-one-wp-migration-import-stuck/#Solution_1_All_in_one_wp_migration_stuck_at_100_or_less">https://webhostingadvices.com/all-in-one-wp-migration-import-stuck/#Solution_1_All_in_one_wp_migration_stuck_at_100_or_less</a><br>高版本的all-in-one-wp-migration无法导入，使用6.7版本的即可<br>下载链接：<a target="_blank" rel="noopener" href="https://webhostingadvices.com/wp-content/uploads/2020/05/all-in-one-wp-migration-6.7.zip">https://webhostingadvices.com/wp-content/uploads/2020/05/all-in-one-wp-migration-6.7.zip</a><br>下载之后插件→安装插件→上传<br>导入完成后，若管理页面显示致命错误，把除了all-in-one-wp-migration以外的插件升级一下即可。<br>然后在设置→固定链接中保存两次</p>
<h3 id="Wordpress添加登录验证码"><a href="#Wordpress添加登录验证码" class="headerlink" title="Wordpress添加登录验证码"></a>Wordpress添加登录验证码</h3><p>安装reCaptcha by BestWebSoft<br>访问谷歌reCAPTCHA，根据指引进行配置<br><a target="_blank" rel="noopener" href="https://melapress.com/support/kb/captcha-4wp-get-google-recaptcha-keys/">https://melapress.com/support/kb/captcha-4wp-get-google-recaptcha-keys/</a><br>进行配置<br><a target="_blank" rel="noopener" href="https://www.google.com/recaptcha/admin/site/664054992/setup">https://www.google.com/recaptcha/admin/site/664054992/setup</a><br>用于提供给用户的HTML代码中使用此网站密钥：<br>网站密钥：密钥记录<br>此密钥用于你的网站和 reCAPTCHA 之间的通信<br>通信密钥：密钥记录</p>
<h2 id="部署discourse（一个论坛）"><a href="#部署discourse（一个论坛）" class="headerlink" title="部署discourse（一个论坛）"></a>部署discourse（一个论坛）</h2><p><a target="_blank" rel="noopener" href="https://hub.docker.com/r/bitnami/discourse">https://hub.docker.com/r/bitnami/discourse</a></p>
<p>docker pull bitnami/discourse<br>docker run -d –name postgresql <br>&nbsp; –env ALLOW_EMPTY_PASSWORD=yes <br>&nbsp; –env POSTGRESQL_USERNAME=你的账户 <br>&nbsp; –env POSTGRESQL_PASSWORD=你的密码 <br>&nbsp; –env POSTGRESQL_DATABASE=bitnami_discourse <br>&nbsp; –network discourse-network <br>&nbsp; –volume discourse_postgr:/bitnami/postgresql <br>&nbsp; bitnami/postgresql</p>
<h2 id="部署dreamacro-clash（跟v2ray一样没用）"><a href="#部署dreamacro-clash（跟v2ray一样没用）" class="headerlink" title="部署dreamacro/clash（跟v2ray一样没用）"></a>部署dreamacro/clash（跟v2ray一样没用）</h2><p>这个是clash客户端的部署，不是v2ray的VMESS代理节点的部署<br>docker pull dreamacro/clash</p>
<p>修改后：<br>docker run –name Clash <br>–network network1 <br>-v clash:/root/.config/clash <br>-d -p 7890:7890 -p 7891:7891 dreamacro/clash</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">services:</span><br><span class="line">&nbsp; clash:</span><br><span class="line">&nbsp;&nbsp;&nbsp; image: dreamacro/clash</span><br><span class="line">&nbsp;&nbsp;&nbsp; volumes:</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ./config.yaml:/root/.config/clash/config.yaml:ro</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # - ./ui:/ui:ro # dashboard volume</span><br><span class="line">&nbsp;&nbsp;&nbsp; ports:</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - "7890:7890"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - "7891:7891"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # - "8080:8080" # The External Controller (RESTful API)</span><br><span class="line">&nbsp;&nbsp;&nbsp; network_mode: "bridge"</span><br></pre></td></tr></tbody></table></figure>


<h2 id="部署v2fly-v2fly-core（不太好用，会被封ip）"><a href="#部署v2fly-v2fly-core（不太好用，会被封ip）" class="headerlink" title="部署v2fly/v2fly-core（不太好用，会被封ip）"></a>部署v2fly/v2fly-core（不太好用，会被封ip）</h2><p>生成UUID：<a target="_blank" rel="noopener" href="https://www.uuidgenerator.net/">https://www.uuidgenerator.net/</a><br><strong>服务端部署：</strong><br>docker pull v2fly/v2fly-core<br>docker run -d –name v2ray <br>–network network1 <br>-v v2ray:/etc/v2fly <br>-p 10086:10086 <br>v2fly/v2fly-core run -c /etc/v2fly/config.json</p>
<p>去服务器上看一下V2ray版本<br>docker logs V2ray<br><strong>客户端部署：</strong><br>客户端部署和服务器同版本的：<br><a target="_blank" rel="noopener" href="https://github.com/v2fly/v2ray-core/releases/download/v5.4.1/v2ray-windows-64.zip">https://github.com/v2fly/v2ray-core/releases/download/v5.4.1/v2ray-windows-64.zip</a></p>
<p><strong>配置参考</strong>：<a target="_blank" rel="noopener" href="https://www.v2fly.org/">https://www.v2fly.org/</a><br><strong>下载安装</strong>：<a target="_blank" rel="noopener" href="https://www.v2fly.org/guide/install.html">https://www.v2fly.org/guide/install.html</a><br><strong>各种版本</strong>：<a target="_blank" rel="noopener" href="https://github.com/v2fly/v2ray-core/releases">https://github.com/v2fly/v2ray-core/releases</a></p>
<h3 id="Vmess-TCP-TLS（安全，但无伪装，容易被封）"><a href="#Vmess-TCP-TLS（安全，但无伪装，容易被封）" class="headerlink" title="Vmess-TCP-TLS（安全，但无伪装，容易被封）"></a>Vmess-TCP-TLS（安全，但无伪装，容易被封）</h3><p>服务端记得安全组开10086端口<br><strong>服务端配置</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes/</span><br><span class="line">chmod 777 -R v2ray</span><br><span class="line">cd /var/lib/docker/volumes/v2ray/_data/</span><br><span class="line">vim config.json</span><br><span class="line">{</span><br><span class="line">&nbsp;&nbsp;&nbsp; "log": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "loglevel": "warning"</span><br><span class="line">&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp; "routing": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "domainStrategy": "AsIs",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "rules": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "type": "field",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ip": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "geoip:private"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ],</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "outboundTag": "block"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp; "inbounds": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "listen": "0.0.0.0",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "port": 10086,</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "vmess",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "settings": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "clients": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "dc****8e-539a-****-****-ff0****d87db"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "streamSettings": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "network": "tcp"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; ],</span><br><span class="line">&nbsp;&nbsp;&nbsp; "outbounds": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "freedom",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "tag": "direct"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "blackhole",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;"tag": "block"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>客户端配置：</strong></p>
<p>1.修改config.json</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">&nbsp;&nbsp;&nbsp; "log": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "loglevel": "warning"</span><br><span class="line">&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp; "routing": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "domainStrategy": "AsIs",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "rules": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "type": "field",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ip": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "geoip:private"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ],</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "outboundTag": "direct"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp; "inbounds": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "listen": "127.0.0.1",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;"port": "1080",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "socks",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "settings": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "auth": "noauth",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "udp": true,</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ip": "127.0.0.1"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "listen": "127.0.0.1",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "port": "1081",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "http"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; ],</span><br><span class="line">&nbsp;&nbsp;&nbsp; "outbounds": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "vmess",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "settings": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "vnext": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "address": "44.***.***.167",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "port": 10086,</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "users": [</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "id": "dc1****e-5**a-4**c-a**2-ff*******7db",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"alterId": 0</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "streamSettings": {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "network": "tcp"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "tag": "proxy"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },</span><br><span class="line">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "protocol": "freedom",</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "tag": "direct"</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>2.修改浏览器代理为127.0.0.1:1081<br>3.在V2ray文件夹下运行cmd<br>4.执行v2ray run</p>
<h2 id="部署nginx"><a href="#部署nginx" class="headerlink" title="部署nginx"></a>部署nginx</h2><p>docker pull nginx<br>docker run –rm -it -d –label=sh.acme.autoload.domain=你的域名 nginx:latest<br>docker run –name nginx <br>–network network1 <br>-v nginx_html:/usr/share/nginx/html <br>-v nginx_nginx:/etc/nginx <br>–label=sh.acme.autoload.domain=你的域名 <br>-d -p 80:80 -p 443:443 nginx</p>
<p>配置文件中return修改一种参考<br>return 301 https://$http_host$request_uri;<br>修改配置文件/var/lib/docker/volumes/nginx_nginx/_data/conf.d/你的域名.conf</p>
<h3 id="配置1测试用"><a href="#配置1测试用" class="headerlink" title="配置1测试用"></a>配置1测试用</h3><p>测试使用，你的域名.conf，配置了80跳转443主页，指向/usr/share/nginx/html</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">server {</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80;</span><br><span class="line">&nbsp;&nbsp;&nbsp; server_name&nbsp; 你的域名 www.你的域名;</span><br><span class="line">&nbsp;&nbsp;&nbsp; return 301 https://你的域名;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">server {</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 443 ssl http2;</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [::]:443 ssl http2;</span><br><span class="line">&nbsp;&nbsp;&nbsp; server_name&nbsp; 你的域名;</span><br><span class="line">&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/share/nginx/html;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_certificate "/etc/nginx/ssl/你的域名/fullchain.cer";</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_certificate_key "/etc/nginx/ssl/你的域名/你的域名.key";</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_session_cache shared:SSL:1m;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_session_timeout&nbsp; 10m;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_prefer_server_ciphers on;</span><br><span class="line">&nbsp;&nbsp;&nbsp; # Load configuration files for the default server block.</span><br><span class="line">&nbsp;&nbsp;&nbsp; include /etc/nginx/default.d/*.conf;</span><br><span class="line">&nbsp;&nbsp;&nbsp; error_page 404 /404.html;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location = /40x.html {</span><br><span class="line">&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; error_page 500 502 503 504 /50x.html;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location = /50x.html {</span><br><span class="line">&nbsp;&nbsp;&nbsp; }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="配置2-WordPress反向代理"><a href="#配置2-WordPress反向代理" class="headerlink" title="配置2 WordPress反向代理"></a>配置2 WordPress反向代理</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/data-magnifier/p/15362218.html">https://www.cnblogs.com/data-magnifier/p/15362218.html</a></p>
<p>wordpress反向代理，配置了80跳转443主页，</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">server {</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80;</span><br><span class="line">&nbsp;&nbsp;&nbsp; server_name&nbsp; 你的域名 www.你的域名;</span><br><span class="line">rewrite ^(.*)$ https://$host$1;</span><br><span class="line">location / {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proxy_set_header Host $host;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proxy_pass http://172.31.80.79:8080;</span><br><span class="line">&nbsp;&nbsp; }</span><br><span class="line">}</span><br><span class="line">server {</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 443 ssl http2;</span><br><span class="line">&nbsp;&nbsp;&nbsp; listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [::]:443 ssl http2;</span><br><span class="line">&nbsp;&nbsp;&nbsp; server_name&nbsp; 你的域名;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_certificate "/etc/nginx/ssl/你的域名/fullchain.cer";</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_certificate_key "/etc/nginx/ssl/你的域名/你的域名.key";</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_session_cache shared:SSL:1m;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_session_timeout&nbsp; 10m;</span><br><span class="line">&nbsp;&nbsp;&nbsp; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">ssl_prefer_server_ciphers on;</span><br><span class="line">location / {</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; proxy_set_header Host $host;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proxy_pass http://172.31.80.79:8080;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">&nbsp;&nbsp;&nbsp; # Load configuration files for the default server block.</span><br><span class="line">&nbsp;&nbsp;&nbsp; include /etc/nginx/default.d/*.conf;</span><br><span class="line">&nbsp;&nbsp;&nbsp; error_page 404 /404.html;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location = /40x.html {</span><br><span class="line">&nbsp;&nbsp;&nbsp; }</span><br><span class="line">&nbsp;&nbsp;&nbsp; error_page 500 502 503 504 /50x.html;</span><br><span class="line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; location = /50x.html {</span><br><span class="line">&nbsp;&nbsp;&nbsp; }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="部署neilpang-acme-sh-获取并部署TLS证书（部署以nginx为例）"><a href="#部署neilpang-acme-sh-获取并部署TLS证书（部署以nginx为例）" class="headerlink" title="部署neilpang/acme.sh 获取并部署TLS证书（部署以nginx为例）"></a>部署neilpang/acme.sh 获取并部署TLS证书（部署以nginx为例）</h2><p><a target="_blank" rel="noopener" href="https://github.com/acmesh-official/acme.sh">https://github.com/acmesh-official/acme.sh</a><br>github：<a target="_blank" rel="noopener" href="https://github.com/acmesh-official/acme.sh/wiki/deploy-to-docker-containers">https://github.com/acmesh-official/acme.sh/wiki/deploy-to-docker-containers</a><br>使用docker部署ACME生成证书</p>
<h3 id="1拉取"><a href="#1拉取" class="headerlink" title="1拉取"></a>1拉取</h3><p>docker pull neilpang/acme.sh</p>
<h3 id="2部署"><a href="#2部署" class="headerlink" title="2部署"></a>2部署</h3><p>正常挂载volume到acme，<br>docker run –rm&nbsp; -itd&nbsp; <br>&nbsp; -v acme:/acme.sh&nbsp; <br>&nbsp; –network network1 <br>&nbsp; –name=acme <br>&nbsp; -v /var/run/docker.sock:/var/run/docker.sock <br>&nbsp; neilpang/acme.sh daemon</p>
<p>-v /var/run/docker.sock:/var/run/docker.sock: 这是Docker的选项，用于将主机的Docker守护进程的Unix套接字文件（/var/run/docker.sock）与容器内的同一路径进行挂载。这个选项的作用是让容器可以与主机上的Docker守护进程进行交互，这样容器内的acme.sh可以与主机的Docker进行通信，例如在容器内运行其他Docker容器。</p>
<p>测试是否能用<br>docker exec acme –help<br>部署后如果需要执行acme的命令，直接执行<br>docker exec acme 命令内容</p>
<h3 id="3设置默认证书颁发机构为Let’s-Encrypt"><a href="#3设置默认证书颁发机构为Let’s-Encrypt" class="headerlink" title="3设置默认证书颁发机构为Let’s Encrypt"></a>3设置默认证书颁发机构为Let’s Encrypt</h3><p>docker exec -it acme –set-default-ca –server letsencrypt<br>docker exec acme –info</p>
<h3 id="4颁发证书"><a href="#4颁发证书" class="headerlink" title="4颁发证书"></a>4颁发证书</h3><p>颁发证书//<strong>此处的Email就是Cloudflare的账户email，key在Cloudflare→个人资料→API令牌→API密钥→Global API Key输入口令获取，获取的key要小心保密</strong>//</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker&nbsp; exec \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e CF_Email=你的邮箱@outlook.com \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e CF_Key=62313448547813494ea30e15a1fe7a54bb5da \</span><br><span class="line">&nbsp;&nbsp;&nbsp; acme --issue -d 你的域名&nbsp; --dns dns_cf</span><br></pre></td></tr></tbody></table></figure>
<p>执行结果如下：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Using CA: https://acme-v02.api.letsencrypt.org/directory</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Create account key ok.</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Registering account: https://acme-v02.api.letsencrypt.org/directory</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Registered</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] ACCOUNT_THUMBPRINT='N***'</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Creating domain key</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] The domain key is here: /acme.sh/你的域名_ecc/你的域名.key</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Single domain='你的域名'</span><br><span class="line">[Fri Jul 28 08:05:06 UTC 2023] Getting domain auth token for each domain</span><br><span class="line">[Fri Jul 28 08:05:07 UTC 2023] Getting webroot for domain='你的域名'</span><br><span class="line">[Fri Jul 28 08:05:07 UTC 2023] Adding txt value: s_qNATn2uZOM5LsTs***cE for domain:&nbsp; _acme-challenge.你的域名</span><br><span class="line">[Fri Jul 28 08:05:08 UTC 2023] Adding record</span><br><span class="line">[Fri Jul 28 08:05:08 UTC 2023] Added, OK</span><br><span class="line">[Fri Jul 28 08:05:08 UTC 2023] The txt record is added: Success.</span><br><span class="line">[Fri Jul 28 08:05:08 UTC 2023] Let's check each DNS record now. Sleep 20 seconds first.</span><br><span class="line">[Fri Jul 28 08:05:28 UTC 2023] You can use '--dnssleep' to disable public dns checks.</span><br><span class="line">[Fri Jul 28 08:05:28 UTC 2023] See: https://github.com/acmesh-official/acme.sh/wiki/dnscheck</span><br><span class="line">[Fri Jul 28 08:05:28 UTC 2023] Checking 你的域名 for _acme-challenge.你的域名</span><br><span class="line">[Fri Jul 28 08:05:29 UTC 2023] Domain 你的域名 '_acme-challenge.你的域名' success.</span><br><span class="line">[Fri Jul 28 08:05:29 UTC 2023] All success, let's return</span><br><span class="line">[Fri Jul 28 08:05:29 UTC 2023] Verifying: 你的域名</span><br><span class="line">[Fri Jul 28 08:05:29 UTC 2023] Pending, The CA is processing your order, please just wait. (1/30)</span><br><span class="line">[Fri Jul 28 08:05:31 UTC 2023] Success</span><br><span class="line">[Fri Jul 28 08:05:31 UTC 2023] Removing DNS records.</span><br><span class="line">[Fri Jul 28 08:05:31 UTC 2023] Removing txt: s_qNATn2uZOM5****mcE for domain: _acme-challenge.你的域名</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:05:33 UTC 2023] Removed: Success</span><br><span class="line">[Fri Jul 28 08:05:33 UTC 2023] Verify finished, start to sign.</span><br><span class="line">[Fri Jul 28 08:05:33 UTC 2023] Lets finalize the order.</span><br><span class="line">[Fri Jul 28 08:05:33 UTC 2023] Le_OrderFinalize='https://acme-v02.api.letsencrypt.org/acme/finalize/122****26/19782****6'</span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] Downloading cert.</span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] Le_LinkCert='https://acme-v02.api.letsencrypt.org/acme/cert/03cb2****cef396****fd93'</span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] Cert success.</span><br><span class="line"></span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line"></span><br><span class="line">MII***</span><br><span class="line"></span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] Your cert is in: /acme.sh/你的域名_ecc/**你的域名.cer**</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] Your cert key is in: /acme.sh/你的域名_ecc/**你的域名.key**</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] The intermediate CA cert is in: /acme.sh/你的域名_ecc/**ca.cer**</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:05:34 UTC 2023] And the full chain certs is there: /acme.sh/你的域名_ecc/**fullchain.cer**</span><br></pre></td></tr></tbody></table></figure>
<p>以上四个文件分别是：</p>
<p>1 /acme.sh/你的域名_ecc/你的域名.cer: 这是你的域名证书文件，其中包含了你申请的SSL/TLS证书。该文件通常包含你的域名、公钥以及证书有效期等信息。这个证书是用于加密传输数据和建立HTTPS安全连接的。</p>
<p>2 /acme.sh/你的域名_ecc/你的域名.key: 这是你的域名私钥文件，它是与证书相对应的私钥。私钥用于解密传输数据和建立安全连接。保护好私钥非常重要，不要泄露给其他人。</p>
<p>3 /acme.sh/你的域名_ecc/ca.cer: 这是中间证书颁发机构（Intermediate CA）的证书文件。在SSL/TLS证书链中，CA证书形成一个层级结构，中间证书颁发机构是处于根证书和你的域名证书之间的一个中间环节。这个文件通常用于构建证书链，以便客户端正确验证你的SSL/TLS证书。</p>
<p>4 /acme.sh/你的域名_ecc/fullchain.cer: 这是完整的证书链文件，包含了你的域名证书以及中间证书颁发机构的证书。这个文件是在TLS握手过程中向客户端发送的，以便客户端正确验证和信任你的SSL/TLS证书。</p>
<p>以上是生成证书步骤，接下来将证书部署到nginx中</p>
<h3 id="5证书部署到nginx"><a href="#5证书部署到nginx" class="headerlink" title="5证书部署到nginx"></a>5证书部署到nginx</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker exec \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_LABEL=sh.acme.autoload.domain=你的域名 \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_KEY_FILE=/etc/nginx/ssl/你的域名/key.pem \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_CERT_FILE="/etc/nginx/ssl/你的域名/cert.pem" \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_CA_FILE="/etc/nginx/ssl/你的域名/ca.pem" \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_FULLCHAIN_FILE="/etc/nginx/ssl/你的域名/full.pem" \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e DEPLOY_DOCKER_CONTAINER_RELOAD_CMD="service nginx force-reload" \</span><br><span class="line">&nbsp;&nbsp;&nbsp; acme --deploy -d 你的域名&nbsp; --deploy-hook docker</span><br></pre></td></tr></tbody></table></figure>

<p><strong>执行结果</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[Fri Jul 28 08:30:11 UTC 2023] The domain '你的域名' seems to have a ECC cert already, lets use ecc cert.</span><br><span class="line">[Fri Jul 28 08:30:11 UTC 2023] Container id: 4c3******16d</span><br><span class="line"></span><br><span class="line">[Fri Jul 28 08:30:11 UTC 2023] Copying file from /acme.sh/你的域名_ecc/你的域名.key to /etc/nginx/ssl/你的域名/key.pem</span><br><span class="line">[Fri Jul 28 08:30:11 UTC 2023] Copying file from /acme.sh/你的域名_ecc/你的域名.cer to /etc/nginx/ssl/你的域名/cert.pem</span><br><span class="line">[Fri Jul 28 08:30:12 UTC 2023] Copying file from /acme.sh/你的域名_ecc/ca.cer to /etc/nginx/ssl/你的域名/ca.pem</span><br><span class="line">[Fri Jul 28 08:30:12 UTC 2023] Copying file from /acme.sh/你的域名_ecc/fullchain.cer to /etc/nginx/ssl/你的域名/full.pem</span><br><span class="line">[Fri Jul 28 08:30:12 UTC 2023] Reloading: service nginx force-reload</span><br><span class="line">[Fri Jul 28 08:30:12 UTC 2023] Success</span><br></pre></td></tr></tbody></table></figure>
<p>把acme的key和fullchain复制到nginx的ssl目录下</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes</span><br><span class="line">cp ./acme/_data/你的域名_ecc/你的域名.key ./nginx_nginx/_data/ssl/你的域名/你的域名.key</span><br><span class="line">cp ./acme/_data/你的域名_ecc/fullchain.cer ./nginx_nginx/_data/ssl/你的域名/fullchain.cer</span><br></pre></td></tr></tbody></table></figure>

<p>如果不是docker都是在本机则使用以下命令</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker exec acme --install-cert -d 你的域名 \</span><br><span class="line">--key-file&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /var/lib/docker/volumes/nginx_nginx/_data/ssl/你的域名/你的域名.key&nbsp; \</span><br><span class="line">--fullchain-file&nbsp; /var/lib/docker/volumes/nginx_nginx/_data/ssl/你的域名/fullchain.cer \</span><br><span class="line">--reloadcmd&nbsp;&nbsp;&nbsp;&nbsp; "service nginx force-reload"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="5证书90天到期后更新"><a href="#5证书90天到期后更新" class="headerlink" title="5证书90天到期后更新"></a>5证书90天到期后更新</h3><p>docker exec acme –info<br>1更新acme.sh脚本工具<br>docker exec acme –upgrade</p>
<p>2更新所有域名的证书<br>docker exec acme –renew-all<br>更新指定域名的证书<br>acme.sh –renew -d 域名</p>
<p>3CDN管理平台重新部署一次SSL证书</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker&nbsp; exec \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e CF_Email=你的邮箱@outlook.com \</span><br><span class="line">&nbsp;&nbsp;&nbsp; -e CF_Key=62313******da \</span><br><span class="line">&nbsp;&nbsp;&nbsp; acme --issue -d 你的域名&nbsp; --dns dns_cf</span><br></pre></td></tr></tbody></table></figure>
<p>4把acme的key和fullchain复制到nginx的ssl目录下</p>
<p>cd /var/lib/docker/volumes<br>cp ./acme/_data/你的域名_ecc/你的域名.key ./nginx_nginx/_data/ssl/你的域名/你的域名.key<br>cp ./acme/_data/你的域名_ecc/fullchain.cer ./nginx_nginx/_data/ssl/你的域名/fullchain.cer<br>docker exec acme –issue -d 你的域名 –nginx</p>
<h2 id="部署Xray-XTLS"><a href="#部署Xray-XTLS" class="headerlink" title="部署Xray/XTLS"></a>部署Xray/XTLS</h2><p>Xray官网：<a target="_blank" rel="noopener" href="https://xtls.github.io/">https://xtls.github.io/</a><br>小小白话文教程：<a target="_blank" rel="noopener" href="https://xtls.github.io/document/level-0/">https://xtls.github.io/document/level-0/</a><br>Docker：<a target="_blank" rel="noopener" href="https://hub.docker.com/r/teddysun/xray">https://hub.docker.com/r/teddysun/xray</a><br>github：<a target="_blank" rel="noopener" href="https://github.com/xtls/Xray-core/releases">https://github.com/xtls/Xray-core/releases</a><br>配置示例：<a target="_blank" rel="noopener" href="https://github.com/XTLS/Xray-examples">https://github.com/XTLS/Xray-examples</a><br>图形化客户端：<a target="_blank" rel="noopener" href="https://github.com/2dust/v2rayN/releases">https://github.com/2dust/v2rayN/releases</a><br>另一个教程：<a target="_blank" rel="noopener" href="https://v2xtls.org/xtls-vision%E4%BB%8B%E7%BB%8D%E5%8F%8A%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8/">https://v2xtls.org/xtls-vision介绍及安装使用/</a><br>正常采用vless协议的xtls-rprx-vision模式即可。<br>REALITY协议：<a target="_blank" rel="noopener" href="https://github.com/XTLS/REALITY">https://github.com/XTLS/REALITY</a></p>
<h3 id="服务端部署"><a href="#服务端部署" class="headerlink" title="服务端部署"></a>服务端部署</h3><p>拉取镜像<br><code>docker pull teddysun/xray</code></p>
<p>Docker image 的文件结构<br>/etc/xray/config.json：配置文件<br>/usr/bin/xray：Xray 主程序<br>/usr/local/share/xray/geoip.dat：IP 数据文件<br>/usr/local/share/xray/geosite.dat：域名数据文件</p>
<p>执行下列命令创建容器</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name xray \</span><br><span class="line">--network network1 \</span><br><span class="line">-v xray_config:/etc/xray/ \</span><br><span class="line">-v xray_dat:/usr/local/share/xray \</span><br><span class="line">-p 9000:9000 \</span><br><span class="line">teddysun/xray</span><br></pre></td></tr></tbody></table></figure>

<h3 id="服务端配合acme配置TLS证书"><a href="#服务端配合acme配置TLS证书" class="headerlink" title="服务端配合acme配置TLS证书"></a>服务端配合acme配置TLS证书</h3><p>在docker使用acme安装crt和key文件到acme容器中的指定文件夹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker exec acme --install-cert -d 你的域名 --ecc \</span><br><span class="line">            --fullchain-file /acme.sh/xray_cert/xray.crt \</span><br><span class="line">            --key-file /acme.sh/xray_cert/xray.key \</span><br><span class="line">--reloadcmd "docker restart xray"</span><br></pre></td></tr></tbody></table></figure>

<p>再通过卷操作把这俩文件整出来</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/volumes/</span><br><span class="line">cp ./acme/_data/xray_cert/xray.crt ./xray_config/_data/xray_cert/xray.crt</span><br><span class="line">cp ./acme/_data/xray_cert/xray.key ./xray_config/_data/xray_cert/xray.key</span><br></pre></td></tr></tbody></table></figure>

<h3 id="服务端配置文件"><a href="#服务端配置文件" class="headerlink" title="服务端配置文件"></a>服务端配置文件</h3><p>生成UUID：<a target="_blank" rel="noopener" href="https://www.uuidgenerator.net/">https://www.uuidgenerator.net/</a><br>配置文件：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">vim /var/lib/docker/volumes/xray_config/_data/config.json</span><br><span class="line">{</span><br><span class="line">  "inbounds": [</span><br><span class="line">    {</span><br><span class="line">      "port": 9000,</span><br><span class="line">      "protocol": "vless",</span><br><span class="line">      "settings": {</span><br><span class="line">        "clients": [</span><br><span class="line">          {</span><br><span class="line">            "id": "生成的UUID",</span><br><span class="line">            "flow": "xtls-rprx-vision",</span><br><span class="line">            "level": 0</span><br><span class="line">          }</span><br><span class="line">        ],</span><br><span class="line">        "decryption": "none",</span><br><span class="line">        "fallbacks": [</span><br><span class="line">          {</span><br><span class="line">            "dest": 80 </span><br><span class="line">          }</span><br><span class="line">        ]</span><br><span class="line">      },</span><br><span class="line">      "streamSettings": {</span><br><span class="line">        "network": "tcp",</span><br><span class="line">        "security": "tls",</span><br><span class="line">        "tlsSettings": {</span><br><span class="line">          "alpn": "http/1.1",</span><br><span class="line">          "certificates": [</span><br><span class="line">            {</span><br><span class="line">              "certificateFile": "/etc/xray/xray_cert/xray.crt",</span><br><span class="line">              "keyFile": "/etc/xray/xray_cert/xray.key"</span><br><span class="line">            }</span><br><span class="line">          ]</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  ],</span><br><span class="line">  "outbounds": [</span><br><span class="line">    {</span><br><span class="line">      "tag": "direct",</span><br><span class="line">      "protocol": "freedom"</span><br><span class="line">    }</span><br><span class="line">  ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="客户端部署"><a href="#客户端部署" class="headerlink" title="客户端部署"></a>客户端部署</h3><p><a target="_blank" rel="noopener" href="https://github.com/xtls/Xray-core/releases">https://github.com/xtls/Xray-core/releases</a><br><a target="_blank" rel="noopener" href="https://github.com/XTLS/Xray-core/releases/download/v1.8.3/Xray-windows-64.zip">https://github.com/XTLS/Xray-core/releases/download/v1.8.3/Xray-windows-64.zip</a><br>下载和服务器相同版本的即可</p>
<h3 id="客户端配置文件"><a href="#客户端配置文件" class="headerlink" title="客户端配置文件"></a>客户端配置文件</h3><p>客户端解压出来文件夹下建立一个config.json文件<br>{<br>    “log”: {<br>        “loglevel”: “warning”<br>    },<br>    “inbounds”: [<br>        {<br>            “listen”: “127.0.0.1”,<br>            “port”: 1081,<br>            “protocol”: “socks”,<br>            “settings”: {<br>                “udp”: true<br>            },<br>            “sniffing”: {<br>                “enabled”: true,<br>                “destOverride”: [<br>                    “http”,<br>                    “tls”<br>                ]<br>            }<br>        }<br>    ],<br>    “outbounds”: [<br>        {<br>            “protocol”: “vless”,<br>            “settings”: {<br>                “vnext”: [<br>                    {<br>                        “address”: “服务器IP”,<br>                        “port”: 9000,<br>                        “users”: [<br>                            {<br>                                “id”: “UUID”,<br>                                “encryption”: “none”,<br>                                “flow”: “xtls-rprx-vision”<br>                            }<br>                        ]<br>                    }<br>                ]<br>            },<br>            “streamSettings”: {<br>                “network”: “tcp”,<br>                “security”: “tls”,<br>                “tlsSettings”: {<br>                    “serverName”: “你的域名”,<br>                    “allowInsecure”: false,<br>                    “fingerprint”: “chrome”<br>                }<br>            },<br>            “tag”: “proxy”<br>        },<br>        {<br>            “protocol”: “freedom”,<br>            “tag”: “direct”<br>        },<br>        {<br>            “protocol”: “blackhole”,<br>            “tag”: “block”<br>        }<br>    ]<br>}</p>
<h3 id="客户端启动"><a href="#客户端启动" class="headerlink" title="客户端启动"></a>客户端启动</h3><p>xray.exe run</p>
<p>可以建立一个xray_run.bat文件：<br>@echo off<br>pushd “%~dp0”<br>xray run<br>popd</p>
<h3 id="ClashVerge客户端部署、配置、启动"><a href="#ClashVerge客户端部署、配置、启动" class="headerlink" title="ClashVerge客户端部署、配置、启动"></a>ClashVerge客户端部署、配置、启动</h3><p>下载：<br>1.3.6<br><a target="_blank" rel="noopener" href="https://ghproxy.com/https://github.com/zzzgydi/clash-verge/releases/download/v1.3.6/Clash.Verge_1.3.6_x64_zh-CN.msi">https://ghproxy.com/https://github.com/zzzgydi/clash-verge/releases/download/v1.3.6/Clash.Verge_1.3.6_x64_zh-CN.msi</a><br>1.4.5<br><a target="_blank" rel="noopener" href="https://mirror.ghproxy.com/https://github.com/clash-verge-rev/clash-verge-rev/releases/download/v1.4.5/Clash.Verge_1.4.5_x64-setup.exe">https://mirror.ghproxy.com/https://github.com/clash-verge-rev/clash-verge-rev/releases/download/v1.4.5/Clash.Verge_1.4.5_x64-setup.exe</a></p>
<p>1下载ClashVerge客户端<br>2安装，启动，<br>    设置中文：Settings→VergeSetting→Language→English改成中文<br>    配置内核版本为Meta：设置→Clash内核→点那个小齿轮→选Clash Meta<br>3配置→新建→类型（选Local）→名称（自己定）→保存<br>4配置→选择刚才建立的配置文件→右键→编辑文件→把下面的内容粘贴进去</p>
<p>mixed-port: 7890<br>allow-lan: true<br>ipv6: true<br>bind-address: ‘*’<br>mode: rule<br>log-level: info<br>external-controller: ‘127.0.0.1:9090’<br>unified-delay: true<br>tcp-concurrent: true<br>dns:<br>  enable: true<br>  listen: ‘0.0.0.0:1053’<br>  enhanced-mode: fake-ip<br>  fake-ip-range: 198.18.0.1/16<br>  default-nameserver:<br>    - 119.29.29.29<br>    - 180.76.76.76<br>    - 223.5.5.5<br>  nameserver:<br>    - 119.29.29.29<br>    - 180.76.76.76<br>    - 223.5.5.5<br>  fallback:<br>    - 1.1.1.1<br>    - 208.67.222.222<br>    - 8.8.8.8<br>  fallback-filter:<br>    geoip: true<br>    ipcidr:<br>      - 240.0.0.0/4<br>      - 0.0.0.0/32</p>
<h2 id="proxies"><a href="#proxies" class="headerlink" title="proxies:"></a>proxies:</h2><pre><code>name: AmazonVLESS
type: vless
server: 服务器IP
port: 9000
uuid: UUID
network: tcp
tls: true
udp: true
flow: xtls-rprx-vision
client-fingerprint: chrome
servername: 你的域名
</code></pre>
<p>rules:</p>
<ul>
<li>MATCH,AmazonVLESS</li>
</ul>
<p>mixed-port: 7890<br>allow-lan: true<br>ipv6: true<br>bind-address: ‘*’<br>mode: rule<br>log-level: info<br>external-controller: ‘127.0.0.1:9090’<br>unified-delay: true<br>tcp-concurrent: true<br>dns:<br>  enable: true<br>  listen: ‘0.0.0.0:1053’<br>  enhanced-mode: fake-ip<br>  fake-ip-range: 198.18.0.1/16<br>  default-nameserver:<br>    - 119.29.29.29<br>    - 180.76.76.76<br>    - 223.5.5.5<br>  nameserver:<br>    - 119.29.29.29<br>    - 180.76.76.76<br>    - 223.5.5.5<br>  fallback:<br>    - 1.1.1.1<br>    - 208.67.222.222<br>    - 8.8.8.8<br>  fallback-filter:<br>    geoip: true<br>    ipcidr:<br>      - 240.0.0.0/4<br>      - 0.0.0.0/32</p>
<h2 id="proxies-1"><a href="#proxies-1" class="headerlink" title="proxies:"></a>proxies:</h2><pre><code>name: AmazonVLESS
type: vless
server: 服务器IP
port: 9000
uuid: uuid
network: tcp
tls: true
udp: true
flow: xtls-rprx-vision
client-fingerprint: chrome
servername: 你的域名
</code></pre>
<p>rules:</p>
<ul>
<li>MATCH,AmazonVLESS</li>
</ul>
<h2 id="部署人生重开器"><a href="#部署人生重开器" class="headerlink" title="部署人生重开器"></a>部署人生重开器</h2><p>docker pull xqtest/liferestart</p>
<p>docker run –name liferestart –network network1 <br>-d -p 8080:80 xqtest/liferestart</p>
<p>http//ip:[port]/view/index.html</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Eschaton</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/posts/c91d58ff.html">http://example.com/posts/c91d58ff.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Eschaton的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%87%AA%E5%BB%BA/">自建</a><a class="post-meta__tags" href="/tags/Docker/">Docker</a><a class="post-meta__tags" href="/tags/Apache/">Apache</a><a class="post-meta__tags" href="/tags/MariaDB/">MariaDB</a><a class="post-meta__tags" href="/tags/Wordpress/">Wordpress</a><a class="post-meta__tags" href="/tags/Nginx/">Nginx</a><a class="post-meta__tags" href="/tags/acme-sh/">acme.sh</a></div><div class="post_share"><div class="social-share" data-image="https://gh.api.99988866.xyz/https://raw.githubusercontent.com/Eschaton2023/Picture/pic/img202407031355805.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/935bc735.html" title="【方法】Linux相关命令"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">【方法】Linux相关命令</div></div></a></div><div class="next-post pull-right"><a href="/posts/ae43a55f.html" title="【方法】AmazonAWS搭建笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">【方法】AmazonAWS搭建笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/f593d515.html" title="【方法】Github+PicGO搭建图床"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">【方法】Github+PicGO搭建图床</div></div></a></div><div><a href="/posts/ad3c2edd.html" title="【方法】Git+NodeJS+Hexo+Github搭建博客的方法"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-26</div><div class="title">【方法】Git+NodeJS+Hexo+Github搭建博客的方法</div></div></a></div><div><a href="/posts/ef3fa9c1.html" title="【工具】装机安装软件合集"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-08-01</div><div class="title">【工具】装机安装软件合集</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#CentOS7-%E5%AE%89%E8%A3%85docker"><span class="toc-number">1.</span> <span class="toc-text">CentOS7 安装docker</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">Docker安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker-compose%E5%AE%89%E8%A3%85%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">Docker-compose安装：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker%E6%93%8D%E4%BD%9C"><span class="toc-number">4.</span> <span class="toc-text">Docker操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">镜像操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E5%A4%96%E9%83%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">4.2.</span> <span class="toc-text">容器外部操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E5%86%85%E9%83%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">4.3.</span> <span class="toc-text">容器内部操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E6%93%8D%E4%BD%9C"><span class="toc-number">4.4.</span> <span class="toc-text">数据卷操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%93%8D%E4%BD%9C"><span class="toc-number">4.5.</span> <span class="toc-text">网络操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Apache"><span class="toc-number">4.6.</span> <span class="toc-text">部署Apache</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2MariaDB"><span class="toc-number">4.7.</span> <span class="toc-text">部署MariaDB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Wordpress"><span class="toc-number">4.8.</span> <span class="toc-text">部署Wordpress</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordpress%E5%A4%87%E4%BB%BD%E5%8F%8A%E5%AF%BC%E5%85%A5"><span class="toc-number">4.8.1.</span> <span class="toc-text">Wordpress备份及导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wordpress%E6%B7%BB%E5%8A%A0%E7%99%BB%E5%BD%95%E9%AA%8C%E8%AF%81%E7%A0%81"><span class="toc-number">4.8.2.</span> <span class="toc-text">Wordpress添加登录验证码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2discourse%EF%BC%88%E4%B8%80%E4%B8%AA%E8%AE%BA%E5%9D%9B%EF%BC%89"><span class="toc-number">4.9.</span> <span class="toc-text">部署discourse（一个论坛）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2dreamacro-clash%EF%BC%88%E8%B7%9Fv2ray%E4%B8%80%E6%A0%B7%E6%B2%A1%E7%94%A8%EF%BC%89"><span class="toc-number">4.10.</span> <span class="toc-text">部署dreamacro/clash（跟v2ray一样没用）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2v2fly-v2fly-core%EF%BC%88%E4%B8%8D%E5%A4%AA%E5%A5%BD%E7%94%A8%EF%BC%8C%E4%BC%9A%E8%A2%AB%E5%B0%81ip%EF%BC%89"><span class="toc-number">4.11.</span> <span class="toc-text">部署v2fly/v2fly-core（不太好用，会被封ip）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Vmess-TCP-TLS%EF%BC%88%E5%AE%89%E5%85%A8%EF%BC%8C%E4%BD%86%E6%97%A0%E4%BC%AA%E8%A3%85%EF%BC%8C%E5%AE%B9%E6%98%93%E8%A2%AB%E5%B0%81%EF%BC%89"><span class="toc-number">4.11.1.</span> <span class="toc-text">Vmess-TCP-TLS（安全，但无伪装，容易被封）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2nginx"><span class="toc-number">4.12.</span> <span class="toc-text">部署nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE1%E6%B5%8B%E8%AF%95%E7%94%A8"><span class="toc-number">4.12.1.</span> <span class="toc-text">配置1测试用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE2-WordPress%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">4.12.2.</span> <span class="toc-text">配置2 WordPress反向代理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2neilpang-acme-sh-%E8%8E%B7%E5%8F%96%E5%B9%B6%E9%83%A8%E7%BD%B2TLS%E8%AF%81%E4%B9%A6%EF%BC%88%E9%83%A8%E7%BD%B2%E4%BB%A5nginx%E4%B8%BA%E4%BE%8B%EF%BC%89"><span class="toc-number">4.13.</span> <span class="toc-text">部署neilpang/acme.sh 获取并部署TLS证书（部署以nginx为例）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E6%8B%89%E5%8F%96"><span class="toc-number">4.13.1.</span> <span class="toc-text">1拉取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E9%83%A8%E7%BD%B2"><span class="toc-number">4.13.2.</span> <span class="toc-text">2部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E8%AE%BE%E7%BD%AE%E9%BB%98%E8%AE%A4%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91%E6%9C%BA%E6%9E%84%E4%B8%BALet%E2%80%99s-Encrypt"><span class="toc-number">4.13.3.</span> <span class="toc-text">3设置默认证书颁发机构为Let’s Encrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E9%A2%81%E5%8F%91%E8%AF%81%E4%B9%A6"><span class="toc-number">4.13.4.</span> <span class="toc-text">4颁发证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E8%AF%81%E4%B9%A6%E9%83%A8%E7%BD%B2%E5%88%B0nginx"><span class="toc-number">4.13.5.</span> <span class="toc-text">5证书部署到nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E8%AF%81%E4%B9%A690%E5%A4%A9%E5%88%B0%E6%9C%9F%E5%90%8E%E6%9B%B4%E6%96%B0"><span class="toc-number">4.13.6.</span> <span class="toc-text">5证书90天到期后更新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2Xray-XTLS"><span class="toc-number">4.14.</span> <span class="toc-text">部署Xray/XTLS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%83%A8%E7%BD%B2"><span class="toc-number">4.14.1.</span> <span class="toc-text">服务端部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E5%90%88acme%E9%85%8D%E7%BD%AETLS%E8%AF%81%E4%B9%A6"><span class="toc-number">4.14.2.</span> <span class="toc-text">服务端配合acme配置TLS证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.14.3.</span> <span class="toc-text">服务端配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%83%A8%E7%BD%B2"><span class="toc-number">4.14.4.</span> <span class="toc-text">客户端部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">4.14.5.</span> <span class="toc-text">客户端配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%90%AF%E5%8A%A8"><span class="toc-number">4.14.6.</span> <span class="toc-text">客户端启动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ClashVerge%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%83%A8%E7%BD%B2%E3%80%81%E9%85%8D%E7%BD%AE%E3%80%81%E5%90%AF%E5%8A%A8"><span class="toc-number">4.14.7.</span> <span class="toc-text">ClashVerge客户端部署、配置、启动</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxies"><span class="toc-number">4.15.</span> <span class="toc-text">proxies:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxies-1"><span class="toc-number">4.16.</span> <span class="toc-text">proxies:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E4%BA%BA%E7%94%9F%E9%87%8D%E5%BC%80%E5%99%A8"><span class="toc-number">4.17.</span> <span class="toc-text">部署人生重开器</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2024 By Eschaton</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax="">
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:24%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover1.webp);"> <a class="categoryBar-list-link" href="categories/【工具】/">【工具】</a><span class="categoryBar-list-count">11</span><span class="categoryBar-list-descr">密评</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover2.webp);"> <a class="categoryBar-list-link" href="categories/【方法】/">【方法】</a><span class="categoryBar-list-count">20</span><span class="categoryBar-list-descr">工具</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover3.webp);"> <a class="categoryBar-list-link" href="categories/【密评】/">【密评】</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">方法</span></li><li class="categoryBar-list-item" style="background:url(https://npm.elemecdn.com/akilar-candyassets/image/cover4.webp);"> <a class="categoryBar-list-link" href="categories/【知识】/">【知识】</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">知识</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><!-- hexo injector body_end end --></body></html>